<!doctype html>
<html>
    <head>
        <meta name="viewport" content="initial-scale=1,maximum-scale=5,minimum-scale=1,width=device-width">
        <title>AML Browser Tests</title>
    </head>
    <body ws-x="@app theme[tron]">
        <script src="https://cdn.jsdelivr.net/npm/@axel669/windstorm@0.1.17/dist/browser.js"></script>
        <script type="module">
            import { html, render, useState } from "https://unpkg.com/htm/preact/standalone.module.js"

            // const f = (props) => {
            //     const [n, set] = useState(0)
            //     console.log("calc")
            //     return html`
            //         <div>
            //             value: ${n}
            //         <//>
            //         <button onClick=${() => set(n + 1)}>
            //             Clicky
            //         <//>
            //     `
            // }
            // render(
            //     html`<${f} />`,
            //     document.body
            // )

            // import htm from "https://unpkg.com/htm?module"
            import vhtml from "https://esm.sh/vhtml"
            import aml from "./lib/tag.mjs"
            import { h } from "https://esm.sh/preact"
            import * as _wut from "https://esm.sh/@preact/signals"

            // console.log(vhtml)

            // const html = htm.bind(
            //     (type, props, ...children) => ({ type, props, children })
            // )
            // const vhtm = htm.bind(vhtml)

            // const c = new Map()
            // function t(parts, ...values) {
            //     // console.log(this)
            //     // console.log(c, parts)
            //     console.log(c.has(parts))
            //     c.set(parts, 0)
            // }
            // const f = () => t`test`

            // f()
            // f()
            // f()
            // f()
            // f()
            // t`test${0}`
            // t`test${0}`

            // let i = 0
            // console.log(aml`:div [.a "1"] Test: ${i}`)
            // console.log(aml`:div [.a "1"] Test: ${i}`)
            // console.log(aml`:div [.a "1"] Test: ${i}`)

            // aml`:div [.a "1"] Test`
            // aml`:div [.a "1"] ${0} Test`
            // console.log([...cache.values()].join("\n"))
            // const f = [...cache.entries()][0][1]
            // console.log(f.toString())

            const atml = aml.use(h)
            // for (let i = 0; i < 10; i += 1) {
            //     const lim = 100000

            //     console.log("-".repeat(30))

            //     console.time("aml")
            //     for (let i = 0; i < lim; i += 1) {
            //         // f()
            //         atml`:div [.a ${i}] Test: ${i}`
            //     }
            //     console.timeEnd("aml")

            //     console.time("htm")
            //     for (let i = 0; i < lim; i += 1) {
            //         html`<div a=${i}>Test: ${i}<//>`
            //     }
            //     console.timeEnd("htm")
            // }

            // console.log(
            //     vhtm`
            //         <script>
            //             const t = 0
            //             const t2 = 1
            //         <//>
            //         <div>
            //             hi
            //             test
            //         <//>
            //     `.join("\n")
            // )

            // console.log(
            //     aml.use(vhtml)`
            //         :script
            //             const t = 0
            //             const t2 = 1

            //         :div
            //             hi
            //             test lines
            //             :div
            //                 indented?
            //     `.join("\n")
            // )

            const wat = (...args) => console.log(args)
            const blep = { a: 10 }
            render(
                atml`
                    :script
                        const t = "test"
                    :label
                    .ws-x @control
                        :input
                        .type checkbox
                        / more value
                        .checked item.done
                        .onChange ${wat}
                        ...${blep}

                        :div
                        .ws-x $text p[4px]
                        .style flex-grow: 1;
                            item.text

                    :div some content
                `,
                document.body
            )
        </script>
    </body>
</html>
